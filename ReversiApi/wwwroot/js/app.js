"use strict";var Reversi=function(){var e,n={cols:8,rows:8},t=1,o={blank:{id:0,color:"white"},white:{id:1,color:"white"},black:{id:2,color:"black"}},a=function(){Reversi.model.init().then(function(n){e=JSON.parse(n.response.board)}).then(function(){s()}).then(function(){r()})},s=function(){document.getElementById("board").innerHTML="";for(var t=document.createElement("table"),a=0;a<n.rows;a++){var s=document.createElement("tr");t.appendChild(s);for(var r=0;r<n.cols;r++){var l=document.createElement("td"),d=document.createElement("span");d.classList.add("stone"),d.classList.add("animate");var u=e[a][r],m=void 0;switch(u){case 0:d.style.visibility="hidden",m=o.blank;break;case 1:m=o.white;break;case 2:d.classList.add("black"),m=o.black}s.appendChild(l),l.appendChild(d),e[a][r]=i(d,m),d.classList.toggle("animate"),c(l,a,r)}}document.getElementById("board").appendChild(t)},r=function(){setInterval(function(){Reversi.model.poll().then(function(n){e=JSON.parse(n.response.board),t=n.response.onSet}).then(function(){s()})},1500)},i=function(e,n){return{state:n,elem:e}},c=function(e,n,t){e.onclick=function(e){Reversi.model.move(n,t)}};return{init:a}}();Reversi.model=function(){var e={gametoken:null,turnUrl:null,env:"production"},n=function(n,o){var a=window.location.href.toString(),s=a.match(/\#(?:access_token)\=([\S\s]*?)\&/)[1];return e.env=o,e.gametoken=s,t()},t=function(){return"development"==e.env?new Promise(function(e,n){e({name:"load_board",response:response})}):new Promise(function(n,t){$.ajax({url:"https://localhost:44375/api/game/"+e.gametoken,method:"GET",success:function(e){n({name:"load_board",response:e})},error:function(e){t({name:"load_board",response:e})}})})};return{init:n,move:function(n,t){return new Promise(function(o,a){$.ajax({url:"https://localhost:44375/api/game/move",method:"PUT",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({moveX:n,moveY:t,GameToken:e.gametoken.toString()}),success:function(e){console.log(e),o({name:"setmove",response:e})}})})},poll:t}}();